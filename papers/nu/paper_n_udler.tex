
\subsection{Introduction \label{introduction}}

The focus of the class is on basic machine learning (ML) ideas and concepts. This approach allows students to easily acquire the terminology and continue to study independently after finishing the class -  through books, videos  and software documentation.  The course is project-based. Each time the selection of the projects is different. It depends on the math knowledge of the students. First several projects are demonstrated to the whole class and utilize minimal mathematical background among participants. Students do not have to learn new math but see how their existing math knowledge can be used in ML.   

Many students already have experience with some ML methods. Our class is helpful for understanding similarities between familiar methods.  For example, first discussion of neural networks is provided after linear and logistic regressions are introduced - as their generalization. Such focus on general principles is indispensable when acquiring skills for designing your own ML methods. The minimal mathematical background required for this class is: solving systems of linear equations and inequalities.

Topics of machine learning are grouped by required mathematical background. Relationship with other disciplines is highlighted - statistics, probability, linear algebra, operations research, optimization, financial engineering. Students work in groups.  Members of the group may have different skills, and the reason is to have a variety of skills present in the group: computer programming, mathematics, mathematical modeling, subject matter expert knowledge. This allows to complete realistic projects. Educational software minpy is used for many projects.

\subsection{Objectives and Outcomes \label{objectives and outcomes}}

The objective is to give a student enough skills to recognize ML problems around us, continue self-study using online materials, video lectures,  scientific papers,  write professional resume, find job or apply for advanced education program.

\subsection{Projects \label{projects}}

\subsubsection{Definition \label{definition}}

Demonstration projects show how to solve real life problem using machine learning approach and using ML software libraries or other scientific software libraries. Almost half of class time is devoted to demonstration projects. Students projects are structured in the same manner as demonstration projects. After watching several demonstration projects students are able to start working on their own projects, using guidance from the instructor. 

Project consists of five steps: 

1. Problem setup. 

2. Creating mathematical model of the problem.

A special focus is on representing the model in a form consistent with API of a software that is used to solve the problem.  We encourage the use of standard software tools to reduce the development time, increase the reliability of the solution, and require less math and programming skills.
Students  may still choose to implement the solution from scratch , without using standard software, as a useful exercise. We use scikit-learn and scipy for most demonstrations.

3. Preparing input data.  

4. Developing a solution, writing computer code, calling existing software libraries, and testing  the code.


5. Analyzing the solution. 

When working in groups students may divide the responsibilities inside the group and work on subtasks in parallel: preparing data, writing code, preparing the report, etc. Depending on math background a student may be assigned a project where higher level of math is needed.

\subsubsection{Education Library Minpy \label{education library minpy}}

Education library minpy is open-source library developed with this class in mind. See \cite{MP}  to learn more about this library.

\subsubsection{Demo Projects \label{demo projects}}

Demonstration projects require minimum math background and programming skills. They are based on classical examples from different fields such as operations research, data science, statistics, engineering, and most recent examples from machine learning field. 
One example of the demo project is considered in detail in the Appendix and is based on the Diet Problem, the classical problem from operations research area. It uses food nutrition datasets  and several toy datasets. The formulation of the problem is becoming more complex gradually, allowing students to participate in the process of building mathematical model. Each modification of the model demonstrates important  ML concept.
Another example is based on movie dataset and takes students through the building of the simple recommendation system. This is a good starting project  for students interested in Natural Language Processing. 

\subsubsection{Student Projects \label{student projects}}

Students may utilize their subject matter expertise, advanced math and programming skills to work on real-life problems. 

Project example for a group with good programming skills and  college level mathematics would be Comparing Genetic Algorithm with Covariance Matrix Adaptation Evolution Strategy, based on minpy library modules.

Project example for group with good programming skills, college-level mathematics and expertise in finance would be Portfolio selection using Black-Litterman approach. 

Project example for a group with good programming skills, college-level mathematics  and special interest in optimization may be Applying proximal operator as a step in generalized global optimization algorithm derived from potential theory. See Appendix for the description.

\subsection{Appendix \label{appendix}}

\subsubsection{ Demo project  example - The Diet Problem \label{demo project example}}

Diet problem is a classical problem from the field of Operations Research.  It was explored extensively in 1940s, based on the needs of WWII. Linear programs for resource allocation were formulated by Leonid Kantorovich in 1939. The Diet Problem was formulated as a linear program with the objective of minimizing the cost of a daily diet of a person while fulfilling nutritional requirements. First algorithm for solving linear programs, simplex algorithm, was developed by George Dantzig in 1947. Soon after the duality theorem for linear programming was suggested by John von Neumann, extending capabilities of linear program sensitivity analysis. 
We explore several modifications of the original problem, including the multi objective version, interactive diet selection, taking into account dietitian’s suggestions such as restrictions on certain food combinations, taking into account uncertainty in the input data, etc. We create a framework based on food/nutrition dataset and several Python solvers that allow one to add algorithms and modes easily, analyze data, perform sensitivity analysis on optimization models and store data on typical diet selection and expert data. Such a decision support system can be used for individual diet recommendations and for analysis of typical diets, such as for identifying dietary patterns in certain groups of people. This system can be used by students of AI ,ML,  optimization and simulation to study modeling techniques. Food/nutrition data can be easily understood by beginners as well as students with advanced degrees in different disciplines.  


The following subproblems are useful to specify when studying ML concepts. 

1. Exploring food dadtaset and introducing linear classsification of food items into groups. 

Food/nutrition databset \cite{food} consists of food items with their chemical composition (including fat, protein, carbohydrates, calcium, vitamin A, vitamin C, vitamin B, magnesium, copper, etc.). Different sources list approximated values, ranges, mean values or median values of chemical elements in each food item as it is impossible to measure the composition exactly and the composition of elements may be different in the same kind of vegetable grown in different regions, or stored in different conditions. It makes sense to accommodate this uncertainty in the model for the diet problem. One of the variants we consider is minimizing the price of daily diet under conditions that nutritional needs are satisfied with certain (large) probability. It may be useful to know that allowing 0.01 percent  doubt that my breakfast provides all nutritional needs would make it 10 dollars  cheaper. 
Sensitivity analysis of the model may reveal the fact that we do not need to run the optimization again for creating several similar diets but need to analyze the result of single optimization run. For example, shadow prices (part of sensitivity analysis output in standard optimization tool) show the change in optimal value when right hand side is changed by one unit. This may correspond to a situation when we computed a cost for a diet with maximum of 1500 calories allowed and want to know how much the 1600 calories diet cost without running the optimization tool again.  


This section introduces several ML concepts such as classification, and is helpful in explaining th difference between classification and regression by comparing mathematical models that underly the former and the latter. Perceptron algorithm introduced in 1963 in \cite{ABR} may be introduced herer, as an example of online classification. Simpler dataset may be utilized as sub-example, such as Airplanes dataset.

Another useful and easily implemented analysis  of food dataset is visualizing food items in the space of principal components,  which shows clearer separation of the food items and is used for identifying dietary patterns in different groups of people (see, for example, \cite{CS}. Principal Component Analysis (PCA) is one of widely used ML techniques, implemented in modern ML software (we use Scikit learn implementation) and all classic scinetific libraries. 

scipy.optimize.linprog solver is used for solving diet problem in classic formulation.


2. Historical formulation as linear program, with objective to minimize the cost of the diet and with constraints on daily nutritional requirements.

This section introduces students to mathematical modeling. Mathematical modeling is an essentail step in solving any machine learning problem. Introduction to diet problem allows to acqure these  skills easily, with only needed background being intermediate algebra.


3. Ways to solve this problem with computer and without computer.

We explore different approaches: historical approach (by exhaustive search) and the simplex algorithm of George Danzig, graphical solution in two dimentions. We discuss implementation of this algorithm in modern software, interfacing with Python libraries, Python's linprog function in SciPy optimize

4. Analysis of the solution and additional constraints.

5. Modern formulations, different objectives, applying the model in different industries.

6. Dual problem formulation, analysis of the solution.

One of the interpretations of dual for the diet problem is that certain pharmacy is producing pills such as supplements of protein, fat, calcium, etc., and trying to set the prices for such pills. The pharmacy would like to maximize the price of the pill, however, this price should be in sink with the price of food items that deliver the same chemical elements. If the pill is too expensive many people would prefer to eat real food instead of a supplement. As contemporary diets often include meal replacement shakes or bars, the dual problem can be formulated as maximizing the price of a meal replacement shake. This formulation will be considered in detail. 

This sections introduces the concept of duality necessary in ML models. Historically, essential machine learning tool that used the concept of duality was support vector machines (SVM), see \cite{VC}. Methodologivcally it is sometimes advisable to step back and introduce simpler model whish demonstrates duality such as Morra Game project mentioned in the project list. The only background needed for this section is intermediate algebra. Duality theory opens other ways to analyse the solution of the primal problem intuitevely, but for the purpose of our class we stop here and refer interested students ito additional self-study materials, such as \cite{RV}

7. Formulating the diet problem when nutritional facts about each food item are given as ranges rather than exact numbers.

This reformulation idemonstrates the concept of probabilistic modeling. This is important in ML. It utilizes the students basic knowlege in probabity and statistics.

The following section provides detailed mathematical formulation of all subproblem. Please see \cite{RV} for more background.

We introduce the following notations:

m – number of nutrients, n – number of foods, 

Vector c of unit costs for food item, where  $c_i$ is the unit cost of food i, i=1,n

Matrix A of nutrients in each food item, where  $a_{ij}$ is the amount of nutrient j in food i, i=1,n, j=1,m

Vector b  of daily nutrient requirements, where $b_j$ is the daily  requiremnt for nutrient j, j=1,m

Vector X(decision vector)  of portions of each food item, where $x_i$ -numbers of servings of each food in the daily diet, 


cost of daily diet:

    \begin{equation} 
    c_1x_1+c_2x_+,..+ c_nx_n=\sum_{i=1}^{n}{c_ix_i}
    \end{equation}

amount of nutrient j in daily diet:

    \begin{equation} 
    a_{1j}x_1+a_{2j}x_+,..+ a_{nj}x_n=\sum_{i=1}^{n}{a_{ij}x_i}
    \end{equation}

The objective of the problem is to minimize the cost of daily diet:

    \begin{equation}
   \min_x \sum_{i=1}^{n}{c_ix_i}
    \end{equation}

The constraints that amounts of nutrients j should not be less than the recommended amounts $b_j$ are expressed as follows

   \begin{equation}
    \sum_{i=1}^{n}{a_{ij}x_i}\ge b_j, j=1,m
    \end{equation}

The bounds on decision variables ( constraining number of portions for each food item) are expressed as follows:

   \begin{equation}
    x_i\ge 0, i=1,n
    \end{equation}

It is a good idea to introduc matrix form of the problem as well, for better understanding of how  Python tools for solving such problems (the linprog function from scipy.optimize) are used.

The dual of the diet problem may be interpreted as problem of revenue maximization so that artificial foods are competitive with the real foods in price, where the variable $U=(u_1,..u_n )$ is interpreted as the unit prices of nutrient pills. 
Or, think of some pharmaceutical company which is developing the pills for meal replacement and  trying to maximize its profit under the requirement that the price paid for the nutritional value found in the food item (but replaced by a pill) is not exceeding the cost of the food item.

Revenue maximization objective:

    \begin{equation} 
   \max_u \sum_{j=1}^{n}{b_ju_j}
    \end{equation}

Constraints :

   \begin{equation} 
    \sum_{j=1}^{m}{a_{ij}u_j}\le c_i, i=1,n
    \end{equation}

The bounds on decision variables:

   \begin{equation} 
    u_j\ge 0, j=1,m
    \end{equation}


Now consider some modifications of the original diet problem. 

Many diets do not allow to consume certain food combinations in one meal: for example, this is how to model a constraint on two types of animal protein consumption in the same meal: for each food item i a binary variable $ z_i$ is introduced.  $z_i=0$ if food item i is not an animal protein, and $ z_i=1$ if item i is an animal protein.

The new constraint is


   \begin{equation} % Creates an equation environment and is compiled as math
    \sum_{i=1}^{n}z_i=1
    \end{equation}

This constraint makes the problem integer linear, which may require different solver.

Next we consider probabilistic formulation.

Because chemical composition of food items are not known exactly (represented by matrix A), we assume normal distribution of values for each nutrient in each food item, with mean and standard deviation found in food dataset. We solve the following deterministic equivalent of stochastic optimization problem:

Now A with elements $a_{ij}$ is a matrix of random variables where elements represent amounts of nutrient j in food i, and $a_{ij}$ is normally distributed with mean $\mu_ij$ and standard deviation $\sigma_ij$. 


Constraints in the original problem are modified to accomodate uncertainty: probability that requirement for nutrient j is satisfied is greater than certain probability p 

   \begin{equation} % Creates an equation environment and is compiled as math
  P(  -\sum_{i=1}^{n}{a_{ij}x_i}\le - b_j) >p, j=1,m
    \end{equation}

This is a chance-constrained problem but can be transformed to linear program as follows:

Note that linear combination  of independent (assumed) normally distributed random variables $\sum_{i=1}^{n}{a_{ij}x_i}$ is normally distributed with mean  $\sum_{i=1}^{n}{\mu_{ij}x_i}$  and standard deviation  $\sqrt (\sum_{i=1}^{n}{\sigma_{ij}^2x_i^2})$ 

Denote the quantile of standard normal distribution by q we get:

$-\sum_{i=1}^{n}{\mu_{ij}x_i}-q \sqrt (\sum_{i=1}^{n}{\sigma_{ij}^2x_i^2}) \le -b_j$ 

$\sum_{i=1}^{n}{\mu_{ij}x_i}+q \sqrt (\sum_{i=1}^{n}{\sigma_{ij}^2x_i^2}) \ge b_j$ 


We used Python linear optimization tool  from ScipPy library (scipy.optimize.linprog) for solving classic formulation of the diet problem. If nonlinear constraints are added the nonlinear solver from scipy library can be used. The new interface for optimization (function minimize) allows to specify constraints, objective function, and solution method.

      \subsubsection{Advanced project example \label{advannced project example} }

Applying proximal operator as a step in generalized global optimization algorithm derived from potential theory


Required background: Python programming, college-level math

Machine learning models are often provided as functions in software packages. Optimization of such functions is a challenging task because traditional derivative based optimization methods with guaranteed convergence properties cannot be used. In \cite{MP} we introduced educational software library minpy that allows to create new optimization methods with desired properties. Those methods include elementary modules designed using the approach for constructing global optimization algorithms based on potential theory \cite{KAP1,KAP2}. They do not use derivatives of objective function and as a result work with nondifferentiable functions (or functions given by computer programs, or black box functions), but have guaranteed convergence. The focus of the library is on the transparency of the generalized optimization method rather than on efficiency of implementation. This is important since this library is intended to be used for educational purposes. To further generalize the optimization algorithms, we suggest replacing certain steps of the algorithms with proximal operator applied to the current point of the search. This does not compromise the convergence of the algorithm  \cite{KAP3}  but allows to write the algorithm in more concise manner, making it more transparent. Suggested reading to learn more about proximal operators and proximal algorithms: \cite{LAKLG,RGMN,SGFLZ}


